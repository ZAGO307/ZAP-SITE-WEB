<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZAP | Batteries Imprim√©es en 3D</title>
    <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <nav>
        <a href="#" class="nav-logo">ZAP<span style="color:white">3D</span></a>
        <div class="nav-links">
            <a href="#concept">Le Concept</a>
            <a href="#atelier">Personnaliser</a>
            <a href="#contact">Commander</a>
        </div>
    </nav>

    <div class="hero">
        <span class="tag-local">üìç Fabriqu√© Localement</span>
        <br><br>
        <h1>L'√©nergie <span style="color:#FFC400">sur mesure</span>.</h1>
        <p>Batteries portables haute performance avec coque imprim√©e en 3D. <br>Design robuste, texture grip unique et 100% r√©parable.</p>
        <a href="#atelier" class="btn-action" style="width:auto; text-decoration:none; display:inline-block;">Cr√©er ma ZAP</a>
    </div>

    <div class="grid-arguments" id="concept">
        <div class="arg-card">
            <span class="arg-icone">üèóÔ∏è</span>
            <h3>Structure Robuste</h3>
            <p>L'impression 3D en nid d'abeille absorbe les chocs mieux qu'une coque classique.</p>
        </div>
        <div class="arg-card">
            <span class="arg-icone">üñêÔ∏è</span>
            <h3>Grip Unique</h3>
            <p>La texture stri√©e des couches d'impression offre une prise en main parfaite.</p>
        </div>
        <div class="arg-card">
            <span class="arg-icone">‚ôªÔ∏è</span>
            <h3>√âco-Con√ßu</h3>
            <p>Fabriqu√© √† la demande en PLA. Pas de surproduction, pas de d√©chets.</p>
        </div>
    </div>

    <div class="atelier-section" id="atelier">
        <div style="text-align: center; margin-bottom:40px;">
            <h2 style="font-family:'Arial Black'; text-transform:uppercase;">L'Atelier ZAP</h2>
            <p>Choisissez votre filament, nous lan√ßons l'impression.</p>
        </div>

        <div class="configurateur">
            <div class="preview-3d">
                <img id="image-produit" src="batterie-jaune.jpg" alt="Aper√ßu Batterie 3D">
            </div>

            <form class="options-form">
                <h3>Configuration</h3>
                
                <label>1. Couleur du Filament</label>
                <div class="choix-couleurs">
                    <div class="pastille c-jaune active" data-image="batterie-jaune.jpg" title="Jaune ZAP"></div>
                    <div class="pastille c-noir"  data-image="batterie-noir.jpg" title="Noir Carbone"></div>
                    <div class="pastille c-blanc" data-image="batterie-blanc.jpg" title="Blanc Neige"></div>
                    <div class="pastille c-gris"  data-image="batterie-gris.jpg" title="Gris Indus"></div>
                    <div class="pastille c-rouge" data-image="batterie-rouge.jpg" title="Rouge Vif"></div>
                    <div class="pastille c-bleu"  data-image="batterie-bleu.jpg" title="Bleu Bambu"></div>
                </div>

                <label>2. Mod√®le de puissance</label>
                <select id="select-puissance">
                    <option value="Pocket">ZAP Pocket (10,000 mAh) - 29‚Ç¨</option>
                    <option value="Explorer">ZAP Explorer (20,000 mAh) - 49‚Ç¨</option>
                </select>

                <label>3. Gravure Personnalis√©e (Optionnel +5‚Ç¨)</label>
                <input type="text" id="input-gravure" placeholder="Ex: Lucas, Proj. X, ZAP-01...">

                <div style="border-top:1px solid #444; margin: 20px 0;"></div>
                
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                    <span style="font-size:20px; font-weight:bold;">Total estim√©:</span>
                    <span style="font-size:24px; color:#FFC400; font-weight:bold;">29.00 ‚Ç¨</span>
                </div>

                <button type="button" class="btn-action" onclick="lancerImpression()">
                    Lancer l'impression
                </button>
                <div id="status" style="margin-top:10px; font-size:12px; color:#777;">Pr√™t √† commander</div>
            </form>
        </div>
    </div>

    <footer id="contact">
        &copy; 2026 ZAP 3D. Conception & Impression locale.<br>
        <a href="mailto:atelier@zap.com" style="color:#777;">Nous contacter pour du B2B</a>
    </footer>

    <script>
        // --- LOGIQUE D'AFFICHAGE ---
        const pastilles = document.querySelectorAll('.pastille');
        const imageProduit = document.getElementById('image-produit');

        pastilles.forEach(pastille => {
            pastille.addEventListener('click', function() {
                pastilles.forEach(p => p.classList.remove('active'));
                this.classList.add('active');
                const nouvelleImage = this.getAttribute('data-image');
                if(nouvelleImage) { imageProduit.src = nouvelleImage; }
            });
        });

        // --- LOGIQUE MQTT (ESP32) ---
        // Connexion au broker shiftr.io
        const client = mqtt.connect('wss://public:public@public.cloud.shiftr.io', {
            clientId: 'zap_web_' + Math.random().toString(16).substr(2, 8)
        });

        client.on('connect', () => {
            document.getElementById('status').innerText = "Connect√© √† l'atelier ‚úÖ";
        });

        function lancerImpression() {
            const couleur = document.querySelector('.pastille.active').getAttribute('title');
            const puissance = document.getElementById('select-puissance').value;
            const gravure = document.getElementById('input-gravure').value || "Aucune";
            
            const message = `LANCER|${couleur}|${puissance}|${gravure}`;

            // Envoi du signal √† l'ESP32
            client.publish('zap3d/commande', 'LANCER'); 
            
            document.getElementById('status').innerText = "Signal envoy√© ! üöÄ";
            alert("Commande valid√©e ! L'atelier ZAP lance l'impression de votre batterie " + couleur);
        }
    </script>

</body>
</html>